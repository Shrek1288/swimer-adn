let isAdmin=false;const apiMsg='/messages',apiGal='/gallery',apiUpload='/upload-image';
function loginUser(){const u=document.getElementById('login-username').value.trim(),p=document.getElementById('login-password').value.trim();if(!u||!p)return alert('CompleteazÄƒ toate cÃ¢mpurile.');isAdmin=(u==='admin'&&p==='admin123');document.getElementById('auth-section').style.display='none';document.getElementById('chat-section').style.display='block';document.getElementById('logout-btn').style.display='inline-block';document.querySelector('.gallery-upload').style.display=isAdmin?'block':'none';document.querySelector('.contact-section').style.display='block';loadGallery();}
function logoutUser(){isAdmin=false;document.getElementById('auth-section').style.display='block';document.getElementById('chat-section').style.display='none';document.getElementById('logout-btn').style.display='none';}
async function loadGallery(){const r=await fetch(apiGal),imgs=await r.json(),c=document.getElementById('galleryContainer');c.innerHTML='';imgs.forEach(i=>{const w=document.createElement('div');w.className='img-wrap';const img=document.createElement('img');img.src=i.url;w.append(img);if(isAdmin){const b=document.createElement('button');b.innerText='ðŸ—‘';b.onclick=async()=>{await fetch(`${apiGal}/${i.id}`,{method:'DELETE'});loadGallery();};w.append(b);}c.append(w);});}
async function uploadImage(){const f=document.getElementById('imageInput').files[0];if(!f)return alert('SelecteazÄƒ o imagine.');const fd=new FormData();fd.append('image',f);await fetch(apiUpload,{method:'POST',body:fd});loadGallery();}
function handleFormSubmit(e){e.preventDefault();fetch(e.target.action,{method:'POST',body:new FormData(e.target),headers:{Accept:'application/json'}}).then(r=>r.ok?alert('Trimis!'):alert('Error!'));}